shadow$provide.module$node_modules$$babylonjs$core$Engines$Extensions$engine_readTexture=function(global,require,module,exports){function allocateAndCopyTypedBuffer(type,sizeOrDstBuffer,sizeInBytes=!1,copyBuffer){switch(type){case 3:return type=new Int8Array(sizeOrDstBuffer),copyBuffer&&type.set(new Int8Array(copyBuffer)),type;case 0:return type=new Uint8Array(sizeOrDstBuffer),copyBuffer&&type.set(new Uint8Array(copyBuffer)),type;case 4:return type=sizeOrDstBuffer instanceof ArrayBuffer?new Int16Array(sizeOrDstBuffer):
new Int16Array(sizeInBytes?sizeOrDstBuffer/2:sizeOrDstBuffer),copyBuffer&&type.set(new Int16Array(copyBuffer)),type;case 5:case 8:case 9:case 10:case 2:return type=sizeOrDstBuffer instanceof ArrayBuffer?new Uint16Array(sizeOrDstBuffer):new Uint16Array(sizeInBytes?sizeOrDstBuffer/2:sizeOrDstBuffer),copyBuffer&&type.set(new Uint16Array(copyBuffer)),type;case 6:return type=sizeOrDstBuffer instanceof ArrayBuffer?new Int32Array(sizeOrDstBuffer):new Int32Array(sizeInBytes?sizeOrDstBuffer/4:sizeOrDstBuffer),
copyBuffer&&type.set(new Int32Array(copyBuffer)),type;case 7:case 11:case 12:case 13:case 14:case 15:return type=sizeOrDstBuffer instanceof ArrayBuffer?new Uint32Array(sizeOrDstBuffer):new Uint32Array(sizeInBytes?sizeOrDstBuffer/4:sizeOrDstBuffer),copyBuffer&&type.set(new Uint32Array(copyBuffer)),type;case 1:return type=sizeOrDstBuffer instanceof ArrayBuffer?new Float32Array(sizeOrDstBuffer):new Float32Array(sizeInBytes?sizeOrDstBuffer/4:sizeOrDstBuffer),copyBuffer&&type.set(new Float32Array(copyBuffer)),
type}type=new Uint8Array(sizeOrDstBuffer);copyBuffer&&type.set(new Uint8Array(copyBuffer));return type}Object.defineProperty(exports,"__esModule",{value:!0});exports.allocateAndCopyTypedBuffer=allocateAndCopyTypedBuffer;global=require("module$node_modules$$babylonjs$core$Engines$thinEngine");global.ThinEngine.prototype._readTexturePixelsSync=function(texture,width,height,faceIndex=-1,level=0,buffer=null,flushRenderer=!0,noDataConversion=!1,x=0,y=0){var _a,_b;const gl=this._gl;if(!gl)throw Error("Engine does not have gl rendering context.");
if(!this._dummyFramebuffer){const dummy=gl.createFramebuffer();if(!dummy)throw Error("Unable to create dummy framebuffer");this._dummyFramebuffer=dummy}gl.bindFramebuffer(gl.FRAMEBUFFER,this._dummyFramebuffer);-1<faceIndex?gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_CUBE_MAP_POSITIVE_X+faceIndex,null===(_a=texture._hardwareTexture)||void 0===_a?void 0:_a.underlyingResource,level):gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,null===(_b=texture._hardwareTexture)||
void 0===_b?void 0:_b.underlyingResource,level);faceIndex=void 0!==texture.type?this._getWebGLTextureType(texture.type):gl.UNSIGNED_BYTE;if(noDataConversion)buffer||(buffer=allocateAndCopyTypedBuffer(texture.type,4*width*height));else switch(faceIndex){case gl.UNSIGNED_BYTE:buffer||(buffer=new Uint8Array(4*width*height));faceIndex=gl.UNSIGNED_BYTE;break;default:buffer||(buffer=new Float32Array(4*width*height)),faceIndex=gl.FLOAT}flushRenderer&&this.flushFramebuffer();gl.readPixels(x,y,width,height,
gl.RGBA,faceIndex,buffer);gl.bindFramebuffer(gl.FRAMEBUFFER,this._currentFramebuffer);return buffer};global.ThinEngine.prototype._readTexturePixels=function(texture,width,height,faceIndex=-1,level=0,buffer=null,flushRenderer=!0,noDataConversion=!1,x=0,y=0){return Promise.resolve(this._readTexturePixelsSync(texture,width,height,faceIndex,level,buffer,flushRenderer,noDataConversion,x,y))}}
//# sourceMappingURL=module$node_modules$$babylonjs$core$Engines$Extensions$engine_readTexture.js.map
