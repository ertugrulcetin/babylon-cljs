shadow$provide.module$node_modules$$babylonjs$core$Materials$colorCurves=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});exports.ColorCurves=void 0;global=require("module$node_modules$$babylonjs$core$tslib_es6");var _decorators=require("module$node_modules$$babylonjs$core$Misc$decorators"),_mathColor=require("module$node_modules$$babylonjs$core$Maths$math_color");class ColorCurves{constructor(){this._dirty=!0;this._tempColor=new _mathColor.Color4(0,0,
0,0);this._globalCurve=new _mathColor.Color4(0,0,0,0);this._highlightsCurve=new _mathColor.Color4(0,0,0,0);this._midtonesCurve=new _mathColor.Color4(0,0,0,0);this._shadowsCurve=new _mathColor.Color4(0,0,0,0);this._positiveCurve=new _mathColor.Color4(0,0,0,0);this._negativeCurve=new _mathColor.Color4(0,0,0,0);this._globalHue=30;this._globalExposure=this._globalSaturation=this._globalDensity=0;this._highlightsHue=30;this._highlightsExposure=this._highlightsSaturation=this._highlightsDensity=0;this._midtonesHue=
30;this._midtonesExposure=this._midtonesSaturation=this._midtonesDensity=0;this._shadowsHue=30;this._shadowsExposure=this._shadowsSaturation=this._shadowsDensity=0}get globalHue(){return this._globalHue}set globalHue(value){this._globalHue=value;this._dirty=!0}get globalDensity(){return this._globalDensity}set globalDensity(value){this._globalDensity=value;this._dirty=!0}get globalSaturation(){return this._globalSaturation}set globalSaturation(value){this._globalSaturation=value;this._dirty=!0}get globalExposure(){return this._globalExposure}set globalExposure(value){this._globalExposure=
value;this._dirty=!0}get highlightsHue(){return this._highlightsHue}set highlightsHue(value){this._highlightsHue=value;this._dirty=!0}get highlightsDensity(){return this._highlightsDensity}set highlightsDensity(value){this._highlightsDensity=value;this._dirty=!0}get highlightsSaturation(){return this._highlightsSaturation}set highlightsSaturation(value){this._highlightsSaturation=value;this._dirty=!0}get highlightsExposure(){return this._highlightsExposure}set highlightsExposure(value){this._highlightsExposure=
value;this._dirty=!0}get midtonesHue(){return this._midtonesHue}set midtonesHue(value){this._midtonesHue=value;this._dirty=!0}get midtonesDensity(){return this._midtonesDensity}set midtonesDensity(value){this._midtonesDensity=value;this._dirty=!0}get midtonesSaturation(){return this._midtonesSaturation}set midtonesSaturation(value){this._midtonesSaturation=value;this._dirty=!0}get midtonesExposure(){return this._midtonesExposure}set midtonesExposure(value){this._midtonesExposure=value;this._dirty=
!0}get shadowsHue(){return this._shadowsHue}set shadowsHue(value){this._shadowsHue=value;this._dirty=!0}get shadowsDensity(){return this._shadowsDensity}set shadowsDensity(value){this._shadowsDensity=value;this._dirty=!0}get shadowsSaturation(){return this._shadowsSaturation}set shadowsSaturation(value){this._shadowsSaturation=value;this._dirty=!0}get shadowsExposure(){return this._shadowsExposure}set shadowsExposure(value){this._shadowsExposure=value;this._dirty=!0}getClassName(){return"ColorCurves"}static Bind(colorCurves,
effect,positiveUniform="vCameraColorCurvePositive",neutralUniform="vCameraColorCurveNeutral",negativeUniform="vCameraColorCurveNegative"){colorCurves._dirty&&(colorCurves._dirty=!1,colorCurves._getColorGradingDataToRef(colorCurves._globalHue,colorCurves._globalDensity,colorCurves._globalSaturation,colorCurves._globalExposure,colorCurves._globalCurve),colorCurves._getColorGradingDataToRef(colorCurves._highlightsHue,colorCurves._highlightsDensity,colorCurves._highlightsSaturation,colorCurves._highlightsExposure,
colorCurves._tempColor),colorCurves._tempColor.multiplyToRef(colorCurves._globalCurve,colorCurves._highlightsCurve),colorCurves._getColorGradingDataToRef(colorCurves._midtonesHue,colorCurves._midtonesDensity,colorCurves._midtonesSaturation,colorCurves._midtonesExposure,colorCurves._tempColor),colorCurves._tempColor.multiplyToRef(colorCurves._globalCurve,colorCurves._midtonesCurve),colorCurves._getColorGradingDataToRef(colorCurves._shadowsHue,colorCurves._shadowsDensity,colorCurves._shadowsSaturation,
colorCurves._shadowsExposure,colorCurves._tempColor),colorCurves._tempColor.multiplyToRef(colorCurves._globalCurve,colorCurves._shadowsCurve),colorCurves._highlightsCurve.subtractToRef(colorCurves._midtonesCurve,colorCurves._positiveCurve),colorCurves._midtonesCurve.subtractToRef(colorCurves._shadowsCurve,colorCurves._negativeCurve));effect&&(effect.setFloat4(positiveUniform,colorCurves._positiveCurve.r,colorCurves._positiveCurve.g,colorCurves._positiveCurve.b,colorCurves._positiveCurve.a),effect.setFloat4(neutralUniform,
colorCurves._midtonesCurve.r,colorCurves._midtonesCurve.g,colorCurves._midtonesCurve.b,colorCurves._midtonesCurve.a),effect.setFloat4(negativeUniform,colorCurves._negativeCurve.r,colorCurves._negativeCurve.g,colorCurves._negativeCurve.b,colorCurves._negativeCurve.a))}static PrepareUniforms(uniformsList){uniformsList.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")}_getColorGradingDataToRef(hue,density,saturation,exposure,result){null!=hue&&(hue=ColorCurves._Clamp(hue,
0,360),density=ColorCurves._Clamp(density,-100,100),saturation=ColorCurves._Clamp(saturation,-100,100),exposure=ColorCurves._Clamp(exposure,-100,100),density=ColorCurves._ApplyColorGradingSliderNonlinear(density),density*=.5,exposure=ColorCurves._ApplyColorGradingSliderNonlinear(exposure),0>density&&(density*=-1,hue=(hue+180)%360),ColorCurves._FromHSBToRef(hue,density,50+.25*exposure,result),result.scaleToRef(2,result),result.a=1+.01*saturation)}static _ApplyColorGradingSliderNonlinear(value){value/=
100;let x=Math.abs(value);x=Math.pow(x,2);0>value&&(x*=-1);return 100*x}static _FromHSBToRef(hue,saturation,brightness,result){var h=ColorCurves._Clamp(hue,0,360);saturation=ColorCurves._Clamp(saturation/100,0,1);brightness=ColorCurves._Clamp(brightness/100,0,1);if(0===saturation)result.r=brightness,result.g=brightness,result.b=brightness;else{h/=60;hue=Math.floor(h);const f=h-hue;h=brightness*(1-saturation);const q=brightness*(1-saturation*f);saturation=brightness*(1-saturation*(1-f));switch(hue){case 0:result.r=
brightness;result.g=saturation;result.b=h;break;case 1:result.r=q;result.g=brightness;result.b=h;break;case 2:result.r=h;result.g=brightness;result.b=saturation;break;case 3:result.r=h;result.g=q;result.b=brightness;break;case 4:result.r=saturation;result.g=h;result.b=brightness;break;default:result.r=brightness,result.g=h,result.b=q}}result.a=1}static _Clamp(value,min,max){return Math.min(Math.max(value,min),max)}clone(){return _decorators.SerializationHelper.Clone(()=>new ColorCurves,this)}serialize(){return _decorators.SerializationHelper.Serialize(this)}static Parse(source){return _decorators.SerializationHelper.Parse(()=>
new ColorCurves,source,null,null)}}exports.ColorCurves=ColorCurves;(0,global.__decorate)([(0,_decorators.serialize)()],ColorCurves.prototype,"_globalHue",void 0);(0,global.__decorate)([(0,_decorators.serialize)()],ColorCurves.prototype,"_globalDensity",void 0);(0,global.__decorate)([(0,_decorators.serialize)()],ColorCurves.prototype,"_globalSaturation",void 0);(0,global.__decorate)([(0,_decorators.serialize)()],ColorCurves.prototype,"_globalExposure",void 0);(0,global.__decorate)([(0,_decorators.serialize)()],
ColorCurves.prototype,"_highlightsHue",void 0);(0,global.__decorate)([(0,_decorators.serialize)()],ColorCurves.prototype,"_highlightsDensity",void 0);(0,global.__decorate)([(0,_decorators.serialize)()],ColorCurves.prototype,"_highlightsSaturation",void 0);(0,global.__decorate)([(0,_decorators.serialize)()],ColorCurves.prototype,"_highlightsExposure",void 0);(0,global.__decorate)([(0,_decorators.serialize)()],ColorCurves.prototype,"_midtonesHue",void 0);(0,global.__decorate)([(0,_decorators.serialize)()],
ColorCurves.prototype,"_midtonesDensity",void 0);(0,global.__decorate)([(0,_decorators.serialize)()],ColorCurves.prototype,"_midtonesSaturation",void 0);(0,global.__decorate)([(0,_decorators.serialize)()],ColorCurves.prototype,"_midtonesExposure",void 0);_decorators.SerializationHelper._ColorCurvesParser=ColorCurves.Parse}
//# sourceMappingURL=module$node_modules$$babylonjs$core$Materials$colorCurves.js.map
